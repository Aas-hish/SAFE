{"ast":null,"code":"import { SAFE_DATA } from './data';\nexport function calculateCompletionFromState(appState) {\n  let totalMetrics = 0;\n  let ratedMetrics = 0;\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      metrics.forEach(metric => {\n        const key = `${dimName}||${kpiName}||${metric.name}`;\n        totalMetrics += 1;\n        if (appState.ratings[key]) ratedMetrics += 1;\n      });\n    });\n  });\n  if (totalMetrics === 0) return 0;\n  return Math.round(ratedMetrics / totalMetrics * 100);\n}\nexport function calculateScoresFromState(appState) {\n  const dimensions = {};\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    let dimScoreSum = 0;\n    let dimWeightSum = 0;\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      const kpiKey = `${dimName}||${kpiName}`;\n      const kpiWeight = appState.weights.kpis[kpiKey] || 100 / Object.keys(kpis).length;\n      let kpiMetricScoreSum = 0;\n      let kpiMetricWeightSum = 0;\n      metrics.forEach(metric => {\n        const metricKey = `${dimName}||${kpiName}||${metric.name}`;\n        const rating = appState.ratings[metricKey] || 0;\n        const metricWeight = appState.weights.metrics[metricKey] || 100 / metrics.length;\n        kpiMetricScoreSum += rating * metricWeight;\n        kpiMetricWeightSum += metricWeight;\n      });\n      const kpiAverage = kpiMetricWeightSum > 0 ? kpiMetricScoreSum / kpiMetricWeightSum : 0;\n      dimScoreSum += kpiAverage * kpiWeight;\n      dimWeightSum += kpiWeight;\n    });\n    const dimScore = dimWeightSum > 0 ? dimScoreSum / dimWeightSum : 0;\n    dimensions[dimName] = {\n      score: dimScore\n    };\n  });\n  const dimValues = Object.values(dimensions);\n  const overall = dimValues.length > 0 ? dimValues.reduce((sum, d) => sum + d.score, 0) / dimValues.length : 0;\n  return {\n    overall,\n    dimensions\n  };\n}\nexport function countNonZeroWeightageMetrics(appState) {\n  let count = 0;\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      metrics.forEach(metric => {\n        const metricKey = `${dimName}||${kpiName}||${metric.name}`;\n        const weight = appState.weights.metrics[metricKey] || 100 / metrics.length;\n        if (weight > 0) count += 1;\n      });\n    });\n  });\n  return count;\n}\nexport function getPerformanceCategory(overallScore) {\n  if (overallScore >= 4.5) {\n    return {\n      name: 'Excellent',\n      class: 'badge-excellent'\n    };\n  }\n  if (overallScore >= 3.5) {\n    return {\n      name: 'Good',\n      class: 'badge-good'\n    };\n  }\n  if (overallScore >= 2.5) {\n    return {\n      name: 'Needs Improvement',\n      class: 'badge-warning'\n    };\n  }\n  return {\n    name: 'Critical',\n    class: 'badge-critical'\n  };\n}\nexport function getCriticalMetrics(appState) {\n  console.log('All priorities:', appState.priorities); // Log all priorities\n  const aPriorityMetrics = Object.entries(appState.priorities || {}).filter(([key, priority]) => {\n    console.log(`Checking ${key}: ${priority}`); // Log each priority check\n    return priority === 'A';\n  }).map(([key]) => ({\n    key,\n    score: appState.ratings[key] || 0,\n    name: key.split('||')[2] || key\n  })).sort((a, b) => a.score - b.score);\n  console.log('A priority metrics:', aPriorityMetrics); // Log the filtered results\n  const bottom10Percent = Math.ceil(aPriorityMetrics.length * 0.1);\n  return aPriorityMetrics.slice(0, bottom10Percent || 0);\n}\nexport function generateInsights(scores) {\n  const insights = [];\n  const dimensionsArray = Object.entries(scores.dimensions).map(([name, data]) => ({\n    name,\n    score: data.score\n  }));\n  if (dimensionsArray.length === 0) return insights;\n  const sorted = [...dimensionsArray].sort((a, b) => b.score - a.score);\n  const best = sorted[0];\n  const worst = sorted[sorted.length - 1];\n  insights.push({\n    title: 'Strongest Dimension',\n    description: `${best.name} is currently your strongest area with an average score of ${best.score.toFixed(2)}/5.`\n  });\n  insights.push({\n    title: 'Weakest Dimension',\n    description: `${worst.name} is the lowest-performing dimension at ${worst.score.toFixed(2)}/5. Prioritise targeted interventions here.`\n  });\n  insights.push({\n    title: 'Overall Performance',\n    description: `Your overall SAFE score is ${scores.overall.toFixed(2)}/5. Use this as a baseline and track improvements over time.`\n  });\n  return insights;\n}","map":{"version":3,"names":["SAFE_DATA","calculateCompletionFromState","appState","totalMetrics","ratedMetrics","Object","entries","forEach","dimName","kpis","kpiName","metrics","metric","key","name","ratings","Math","round","calculateScoresFromState","dimensions","dimScoreSum","dimWeightSum","kpiKey","kpiWeight","weights","keys","length","kpiMetricScoreSum","kpiMetricWeightSum","metricKey","rating","metricWeight","kpiAverage","dimScore","score","dimValues","values","overall","reduce","sum","d","countNonZeroWeightageMetrics","count","weight","getPerformanceCategory","overallScore","class","getCriticalMetrics","console","log","priorities","aPriorityMetrics","filter","priority","map","split","sort","a","b","bottom10Percent","ceil","slice","generateInsights","scores","insights","dimensionsArray","data","sorted","best","worst","push","title","description","toFixed"],"sources":["/home/aashish/Desktop/SAFE/src/scoring.js"],"sourcesContent":["import { SAFE_DATA } from './data';\n\nexport function calculateCompletionFromState(appState) {\n  let totalMetrics = 0;\n  let ratedMetrics = 0;\n\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      metrics.forEach((metric) => {\n        const key = `${dimName}||${kpiName}||${metric.name}`;\n        totalMetrics += 1;\n        if (appState.ratings[key]) ratedMetrics += 1;\n      });\n    });\n  });\n\n  if (totalMetrics === 0) return 0;\n  return Math.round((ratedMetrics / totalMetrics) * 100);\n}\n\nexport function calculateScoresFromState(appState) {\n  const dimensions = {};\n\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    let dimScoreSum = 0;\n    let dimWeightSum = 0;\n\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      const kpiKey = `${dimName}||${kpiName}`;\n      const kpiWeight =\n        appState.weights.kpis[kpiKey] ||\n        100 / Object.keys(kpis).length;\n\n      let kpiMetricScoreSum = 0;\n      let kpiMetricWeightSum = 0;\n\n      metrics.forEach((metric) => {\n        const metricKey = `${dimName}||${kpiName}||${metric.name}`;\n        const rating = appState.ratings[metricKey] || 0;\n        const metricWeight =\n          appState.weights.metrics[metricKey] ||\n          100 / metrics.length;\n\n        kpiMetricScoreSum += rating * metricWeight;\n        kpiMetricWeightSum += metricWeight;\n      });\n\n      const kpiAverage =\n        kpiMetricWeightSum > 0\n          ? kpiMetricScoreSum / kpiMetricWeightSum\n          : 0;\n\n      dimScoreSum += kpiAverage * kpiWeight;\n      dimWeightSum += kpiWeight;\n    });\n\n    const dimScore =\n      dimWeightSum > 0 ? dimScoreSum / dimWeightSum : 0;\n\n    dimensions[dimName] = { score: dimScore };\n  });\n\n  const dimValues = Object.values(dimensions);\n  const overall =\n    dimValues.length > 0\n      ? dimValues.reduce((sum, d) => sum + d.score, 0) /\n        dimValues.length\n      : 0;\n\n  return { overall, dimensions };\n}\n\nexport function countNonZeroWeightageMetrics(appState) {\n  let count = 0;\n  Object.entries(SAFE_DATA).forEach(([dimName, kpis]) => {\n    Object.entries(kpis).forEach(([kpiName, metrics]) => {\n      metrics.forEach((metric) => {\n        const metricKey = `${dimName}||${kpiName}||${metric.name}`;\n        const weight =\n          appState.weights.metrics[metricKey] ||\n          100 / metrics.length;\n        if (weight > 0) count += 1;\n      });\n    });\n  });\n  return count;\n}\n\nexport function getPerformanceCategory(overallScore) {\n  if (overallScore >= 4.5) {\n    return { name: 'Excellent', class: 'badge-excellent' };\n  }\n  if (overallScore >= 3.5) {\n    return { name: 'Good', class: 'badge-good' };\n  }\n  if (overallScore >= 2.5) {\n    return { name: 'Needs Improvement', class: 'badge-warning' };\n  }\n  return { name: 'Critical', class: 'badge-critical' };\n}\n\nexport function getCriticalMetrics(appState) {\n  console.log('All priorities:', appState.priorities);  // Log all priorities\n  const aPriorityMetrics = Object.entries(appState.priorities || {})\n    .filter(([key, priority]) => {\n      console.log(`Checking ${key}: ${priority}`);  // Log each priority check\n      return priority === 'A';\n    })\n    .map(([key]) => ({\n      key,\n      score: appState.ratings[key] || 0,\n      name: key.split('||')[2] || key,\n    }))\n    .sort((a, b) => a.score - b.score);\n\n  console.log('A priority metrics:', aPriorityMetrics);  // Log the filtered results\n  const bottom10Percent = Math.ceil(aPriorityMetrics.length * 0.1);\n  return aPriorityMetrics.slice(0, bottom10Percent || 0);\n}\nexport function generateInsights(scores) {\n  const insights = [];\n  const dimensionsArray = Object.entries(scores.dimensions).map(\n    ([name, data]) => ({ name, score: data.score })\n  );\n\n  if (dimensionsArray.length === 0) return insights;\n\n  const sorted = [...dimensionsArray].sort(\n    (a, b) => b.score - a.score\n  );\n\n  const best = sorted[0];\n  const worst = sorted[sorted.length - 1];\n\n  insights.push({\n    title: 'Strongest Dimension',\n    description: `${best.name} is currently your strongest area with an average score of ${best.score.toFixed(\n      2\n    )}/5.`,\n  });\n\n  insights.push({\n    title: 'Weakest Dimension',\n    description: `${worst.name} is the lowest-performing dimension at ${worst.score.toFixed(\n      2\n    )}/5. Prioritise targeted interventions here.`,\n  });\n\n  insights.push({\n    title: 'Overall Performance',\n    description: `Your overall SAFE score is ${scores.overall.toFixed(\n      2\n    )}/5. Use this as a baseline and track improvements over time.`,\n  });\n\n  return insights;\n}\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}